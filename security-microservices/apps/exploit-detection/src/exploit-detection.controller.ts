import { Controller, Get, Res } from '@nestjs/common';
import { ExploitDetectionService } from './exploit-detection.service';

@Controller()
export class ExploitDetectionController {
  constructor(private readonly exploitDetectionService: ExploitDetectionService) {}

  @Get()
  async sendMailer(@Res() response: any) {
    try {
      const mail = await this.exploitDetectionService.sendMail();

      console.log("MAIL SENT", mail);

      return response.status(200).json({
        message: 'success',
        mail,
      });
    } catch (error) {
      console.error("MAIL SEND ERROR", error);

      return response.status(500).json({
        message: 'failed to send mail',
        error: error.message,
      });
    }
  }
}